{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "SmartGrid Telemetry Record",
  "description": "Schema for simulated substation telemetry (one reading).",
  "type": "object",
  "required": ["device_id","timestamp","sensor_type","value"],
  "properties": {
    "device_id": {"type":"string","description":"Unique device identifier (e.g., TS-021, FEEDER-F12)"},
    "timestamp": {"type":"string","format":"date-time","description":"UTC ISO8601 timestamp"},
    "sensor_type": {"type":"string","enum":["voltage","current","frequency","power","power_factor","temperature","vibration","transformer_oil","tap_position","breaker_state","load"],"description":"Type of measurement"},
    "value": {"type":"number","description":"Numeric measurement value (units in `unit` property)"},
    "unit": {"type":"string","description":"Human-friendly unit (e.g., kV, A, Hz, MW, Â°C)"},
    "quality": {"type":"number","minimum":0,"maximum":1,"default":1.0,"description":"Quality indicator (0 = bad, 1 = good)"},
    "sample_rate_hz": {"type":"number","minimum":0.01,"maximum":100.0,"description":"Sample rate in Hz if applicable"},
    "sequence": {"type":"integer","description":"Optional sequence number for packet ordering"},
    "metadata": {"type":"object","description":"Free-form metadata (substation, feeder id, sensor_model)","additionalProperties":true}
  },
  "additionalProperties": false,

  "examples": [
    {
      "device_id": "FEEDER-F12",
      "timestamp": "2026-03-01T10:15:23Z",
      "sensor_type": "voltage",
      "value": 218.5,
      "unit": "kV",
      "quality": 0.98,
      "sample_rate_hz": 0.2,
      "metadata": {"substation":"KPL-03","phase":"L1"}
    }
  ],

  "x:simulation": {
    "defaults": {
      "nominal_voltage_kv": 220,
      "nominal_frequency_hz": 50.0,
      "default_sample_rate_seconds": 10
    },
    "anomaly_injection": {
      "types": {
        "drift": {"description":"Gradual sensor drift","parameters":["start_offset_pct","rate_pct_per_min","duration_minutes"]},
        "step": {"description":"Sudden step change","parameters":["magnitude_pct","start_time","duration_minutes"]},
        "oscillation": {"description":"Low-frequency oscillation","parameters":["amplitude_pct","frequency_hz","duration_seconds"]},
        "dropout": {"description":"Packet loss / missing data","parameters":["drop_probability","start_time","duration_minutes"]}
      },
      "example_medium_voltage_fluctuation": {
        "description":"Repeated voltage sag/swell on a feeder with concurrent failed HMI logins",
        "injections": [
          {"type":"oscillation","sensor_type":"voltage","amplitude_pct":0.11,"frequency_hz":0.01,"duration_seconds":300},
          {"type":"dropout","sensor_type":"voltage","drop_probability":0.1,"duration_minutes":5}
        ]
      }
    }
  }
}
